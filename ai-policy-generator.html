<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Policy Document Generator | Health Department Tool</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=DM+Sans:wght@400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --forest: #1a4d2e;
            --sage: #4f7942;
            --cream: #faf8f3;
            --terracotta: #c1502e;
            --gold: #d4a574;
            --slate: #2d3e4e;
            --mist: #e8ebe6;
        }
        
        body {
            font-family: 'DM Sans', sans-serif;
            background: linear-gradient(135deg, var(--cream) 0%, var(--mist) 100%);
            color: var(--slate);
            line-height: 1.6;
            min-height: 100vh;
            padding: 2rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem 0;
            border-bottom: 3px solid var(--forest);
        }
        
        h1 {
            font-family: 'Crimson Pro', serif;
            font-size: 3rem;
            font-weight: 700;
            color: var(--forest);
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: var(--sage);
            font-weight: 500;
        }
        
        .card {
            background: white;
            border-radius: 16px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            font-weight: 600;
            color: var(--forest);
            margin-bottom: 0.5rem;
        }
        
        input[type="text"],
        select,
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--mist);
            border-radius: 8px;
            font-family: 'DM Sans', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        input[type="text"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--sage);
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .info-box {
            background: linear-gradient(135deg, #fff9f0 0%, #fff 100%);
            border-left: 4px solid var(--gold);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--forest) 0%, var(--sage) 100%);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1rem;
            font-weight: 700;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'DM Sans', sans-serif;
            margin-right: 1rem;
            margin-bottom: 1rem;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 121, 66, 0.3);
        }
        
        .btn-secondary {
            background: white;
            color: var(--forest);
            border: 2px solid var(--forest);
        }
        
        .priority-summary {
            background: var(--cream);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .priority-list {
            list-style: none;
            padding: 0;
        }
        
        .priority-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--mist);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .priority-list li:last-child {
            border-bottom: none;
        }
        
        .rank-badge {
            background: var(--forest);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
        }
        
        .tier-high { background: var(--terracotta); }
        .tier-medium { background: var(--gold); }
        .tier-low { background: var(--sage); }
        
        #policyPreview {
            background: white;
            border: 2px solid var(--mist);
            border-radius: 12px;
            padding: 3rem;
            margin-top: 2rem;
            font-family: 'Georgia', serif;
            line-height: 1.8;
            max-height: 600px;
            overflow-y: auto;
        }
        
        #policyPreview h1 {
            font-family: 'Crimson Pro', serif;
            color: var(--forest);
            border-bottom: 3px solid var(--forest);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        #policyPreview h2 {
            font-family: 'Crimson Pro', serif;
            color: var(--forest);
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        #policyPreview h3 {
            color: var(--sage);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            font-size: 1.2rem;
        }
        
        #policyPreview ul {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }
        
        #policyPreview li {
            margin-bottom: 0.5rem;
        }
        
        .policy-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #fafafa;
            border-left: 4px solid var(--sage);
            border-radius: 4px;
        }
        
        .intensity-selector {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .intensity-option {
            flex: 1;
            padding: 1rem;
            border: 2px solid var(--mist);
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .intensity-option:hover {
            border-color: var(--sage);
        }
        
        .intensity-option.selected {
            border-color: var(--forest);
            background: linear-gradient(135deg, var(--forest) 0%, var(--sage) 100%);
            color: white;
        }
        
        .format-options {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        @media print {
            body {
                background: white;
            }
            .card, .btn, header {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AI Policy Document Generator</h1>
            <p class="subtitle">Create Evidence-Based AI Policies for State & Local Health Departments</p>
        </header>

        <!-- Settings Card -->
        <div class="card">
            <h2 style="font-family: 'Crimson Pro', serif; color: var(--forest); margin-bottom: 1.5rem;">Policy Configuration</h2>
            
            <div class="info-box">
                <h3 style="color: var(--forest); margin-bottom: 0.5rem;">How This Works</h3>
                <p>This tool generates a customized AI policy based on your priorities. Higher-ranked elements receive more detailed requirements and stronger language. Import your rankings from the prioritization tool or manually configure below.</p>
            </div>

            <div class="form-group">
                <label>1. Import Rankings (Optional)</label>
                <input type="file" id="rankingsFile" accept=".json">
                <p style="font-size: 0.85rem; color: var(--sage); margin-top: 0.5rem;">Upload the JSON file from the prioritization tool</p>
            </div>

            <div class="settings-grid">
                <div class="form-group">
                    <label>2. Organization Name *</label>
                    <input type="text" id="orgName" placeholder="e.g., Seattle-King County Public Health" required>
                </div>

                <div class="form-group">
                    <label>3. Jurisdiction Type</label>
                    <select id="jurisdictionType">
                        <option value="state">State Health Department</option>
                        <option value="local">Local Health Department</option>
                        <option value="county">County Health Department</option>
                        <option value="city">City Health Department</option>
                        <option value="tribal">Tribal Health Department</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>4. Organization Size</label>
                    <select id="orgSize">
                        <option value="small">Small (< 50 staff)</option>
                        <option value="medium">Medium (50-200 staff)</option>
                        <option value="large">Large (200+ staff)</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label>5. Policy Intensity Level</label>
                <div class="intensity-selector">
                    <div class="intensity-option" data-intensity="basic">
                        <strong>Basic</strong>
                        <p style="font-size: 0.85rem; margin-top: 0.5rem;">Essential requirements only</p>
                    </div>
                    <div class="intensity-option selected" data-intensity="standard">
                        <strong>Standard</strong>
                        <p style="font-size: 0.85rem; margin-top: 0.5rem;">Balanced approach</p>
                    </div>
                    <div class="intensity-option" data-intensity="comprehensive">
                        <strong>Comprehensive</strong>
                        <p style="font-size: 0.85rem; margin-top: 0.5rem;">Detailed requirements</p>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>6. Additional Context (Optional)</label>
                <textarea id="additionalContext" placeholder="Any specific concerns, existing policies to align with, or special considerations..."></textarea>
            </div>

            <button class="btn" id="generateBtn">Generate Policy Document</button>
            <button class="btn btn-secondary" id="loadSampleBtn">Load Sample Rankings</button>
        </div>

        <!-- Priority Summary Card (hidden initially) -->
        <div class="card" id="priorityCard" style="display: none;">
            <h2 style="font-family: 'Crimson Pro', serif; color: var(--forest); margin-bottom: 1.5rem;">Your Priority Rankings</h2>
            <div class="priority-summary">
                <ul class="priority-list" id="priorityList"></ul>
            </div>
        </div>

        <!-- Policy Preview Card -->
        <div class="card" id="previewCard" style="display: none;">
            <h2 style="font-family: 'Crimson Pro', serif; color: var(--forest); margin-bottom: 1.5rem;">Generated Policy Document</h2>
            
            <div class="format-options">
                <button class="btn" id="downloadDocxBtn">üìÑ Download DOCX</button>
                <button class="btn" id="downloadPdfBtn">üìë Download PDF</button>
                <button class="btn" id="downloadMdBtn">üìù Download Markdown</button>
                <button class="btn btn-secondary" id="copyBtn">üìã Copy to Clipboard</button>
                <button class="btn btn-secondary" id="printBtn">üñ®Ô∏è Print</button>
            </div>

            <div id="policyPreview"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <script>
        // Policy content database with priority-sensitive language
        const policyTemplates = {
            "Data Privacy & Security": {
                high: {
                    title: "Data Privacy and Security",
                    content: `
## Purpose
This organization maintains the highest standards for protecting protected health information (PHI), personally identifiable information (PII), and sensitive data when using artificial intelligence systems.

## Requirements

### Data Classification and Handling
- All data must be classified according to sensitivity level before AI processing
- PHI and PII are strictly prohibited from input into external AI systems including but not limited to ChatGPT, Claude, Gemini, and similar services
- Only de-identified or aggregate data may be used with external AI tools
- Staff must complete data classification training before AI system access

### Technical Safeguards
- All AI systems must comply with HIPAA Security Rule requirements
- Encryption at rest and in transit is mandatory for all AI data processing
- Multi-factor authentication required for all AI system access
- Regular security audits of AI systems conducted quarterly
- Vendor security assessments completed before AI tool procurement

### Data Retention and Disposal
- AI-generated outputs containing sensitive data must follow existing retention schedules
- Secure deletion protocols apply to all AI training data and outputs
- Data breach notification procedures apply to AI systems
- Annual review of data retention practices for AI applications

### Monitoring and Compliance
- Privacy officer reviews all new AI use cases
- Automated monitoring systems track data flows to AI systems
- Regular privacy impact assessments for high-risk AI applications
- Staff violations of data privacy requirements result in immediate access suspension
`
                },
                medium: {
                    title: "Data Privacy and Security",
                    content: `
## Purpose
This organization protects sensitive health information when using AI systems, ensuring compliance with applicable privacy laws and regulations.

## Requirements

### Data Protection Standards
- Protected health information (PHI) and personally identifiable information (PII) shall not be input into external AI systems
- Staff must use only de-identified or aggregate data with AI tools
- All AI systems must meet HIPAA compliance standards where applicable

### Security Measures
- Encryption required for AI data processing
- Access controls implemented for all AI systems
- Regular security reviews of AI vendors and tools
- Data breach protocols apply to AI systems

### Accountability
- Privacy officer approves new AI use cases
- Staff training on data privacy in AI contexts
- Documentation of AI data handling practices
`
                },
                low: {
                    title: "Data Privacy and Security",
                    content: `
## Purpose
Protect sensitive information when using AI systems.

## Requirements
- Do not input PHI or PII into external AI tools
- Use de-identified data only
- Follow existing data security policies
- Report suspected data breaches
`
                }
            },
            "Bias, Equity & Discrimination": {
                high: {
                    title: "Bias Mitigation and Health Equity",
                    content: `
## Purpose
This organization ensures AI systems promote health equity and do not perpetuate or amplify bias, discrimination, or health disparities.

## Requirements

### Pre-Deployment Assessment
- Mandatory equity impact assessment for all AI systems before deployment
- Analysis of training data for representation of protected classes and vulnerable populations
- Evaluation of AI performance across demographic groups including race, ethnicity, age, disability status, language, and socioeconomic status
- Community stakeholder consultation for AI systems affecting public-facing services
- Documentation of potential disparate impacts and mitigation strategies

### Fairness Standards
- AI systems must demonstrate comparable accuracy across all demographic groups
- Performance variance between groups may not exceed 5% without documented justification and mitigation plan
- Proxy discrimination analysis required for all decision-support AI systems
- Regular testing for emergent bias in deployed systems

### Accessibility Requirements
- All AI interfaces must meet WCAG 2.1 Level AA accessibility standards
- Multilingual support required for AI systems serving diverse populations
- Alternative non-AI pathways available for all critical services
- Plain language outputs required for all AI-generated public communications

### Monitoring and Remediation
- Quarterly equity audits of AI system outputs
- Disaggregated data analysis by demographic factors
- Community feedback mechanisms for reporting bias concerns
- Rapid response protocol for identified bias issues
- Annual public reporting of equity metrics for AI systems

### Training and Accountability
- Mandatory bias awareness training for all AI system users and developers
- Leadership accountability for equity outcomes in AI deployment
- Performance evaluations include equity considerations
`
                },
                medium: {
                    title: "Bias Mitigation and Health Equity",
                    content: `
## Purpose
Ensure AI systems support health equity and do not discriminate against protected groups.

## Requirements

### Assessment and Testing
- Equity impact assessment required before deploying new AI systems
- Testing for bias across demographic groups
- Analysis of training data representativeness
- Documentation of fairness considerations

### Standards
- AI systems should perform equitably across populations
- Accessibility standards apply to AI interfaces
- Alternative pathways available for AI-driven services
- Plain language in AI communications

### Monitoring
- Regular review of AI system equity impacts
- Mechanisms for reporting bias concerns
- Annual equity reporting for major AI systems
`
                },
                low: {
                    title: "Bias and Equity",
                    content: `
## Purpose
Prevent discrimination in AI use.

## Requirements
- Consider equity impacts before using AI
- Test AI systems for bias when possible
- Make AI systems accessible
- Provide alternatives to AI when needed
`
                }
            },
            "Transparency & Explainability": {
                high: {
                    title: "Transparency and Explainability",
                    content: `
## Purpose
Maintain public trust through transparent AI practices and ensure AI decision-making processes can be understood and explained.

## Requirements

### Public Disclosure
- Maintain public registry of all AI systems in use, updated quarterly
- Publish AI system documentation including purpose, data sources, and limitations
- Disclose when AI is used in public-facing services or communications
- Annual public report on AI use, impacts, and governance

### Model Documentation
- "Model card" documentation required for all AI systems including:
  - Intended use cases and known limitations
  - Training data sources and characteristics  
  - Performance metrics across demographic groups
  - Maintenance and update schedules
  - Known failure modes and risks
- Version control and change logs for all AI models
- Documentation of AI system decision logic and key variables

### User Notification
- Clear disclosure when individuals interact with AI systems
- Notification when AI contributes to decisions affecting individuals
- Explanation of AI's role in decision-making processes
- Information on how to request human review

### Explainability Standards
- AI systems must provide explanation for outputs when requested
- Decision-support AI must show key factors influencing recommendations
- Technical documentation available to oversight bodies
- Non-technical explanations available for affected individuals

### Accountability and Access
- Designated point of contact for AI transparency questions
- Process for public information requests about AI systems
- Regular stakeholder briefings on AI initiatives
- Board and leadership reporting on AI use and impacts
`
                },
                medium: {
                    title: "Transparency and Explainability",
                    content: `
## Purpose
Ensure transparency in AI use and maintain public trust.

## Requirements

### Disclosure
- Public listing of AI systems in use
- Disclosure when AI is used in public services
- Documentation of AI system purposes and limitations
- Annual reporting on AI activities

### Documentation
- Record AI system capabilities and constraints
- Track AI system versions and updates
- Document data sources for AI systems

### User Communication
- Notify individuals when AI affects them
- Explain AI's role in decisions
- Provide contact for AI-related questions
`
                },
                low: {
                    title: "Transparency",
                    content: `
## Purpose
Be transparent about AI use.

## Requirements
- Disclose AI use to the public
- Keep records of AI systems
- Tell people when AI affects them
- Provide information on request
`
                }
            }
        };

        // Additional templates for remaining elements (abbreviated for length)
        policyTemplates["Human Oversight & Accountability"] = {
            high: {
                title: "Human Oversight and Accountability",
                content: `
## Purpose
Ensure human judgment remains central to decision-making and establish clear accountability for AI system outcomes.

## Requirements

### Human-in-the-Loop Requirements
- AI systems may not make final decisions on matters affecting individual rights, health outcomes, or resource allocation without human review
- Licensed professionals must review and approve AI recommendations in clinical or diagnostic contexts
- Supervisory review required for AI-generated enforcement or compliance decisions
- Override mechanisms available for all AI recommendations

### Professional Judgment
- AI serves as decision support, not decision replacement
- Healthcare providers retain full professional responsibility for patient care decisions
- Public health professionals maintain authority over AI-assisted analyses
- Staff empowered to question or override AI outputs with documentation

### Accountability Framework
- Clear assignment of responsibility for each AI system
- Named system owners accountable for AI outcomes
- Performance metrics include AI system impacts
- Regular audits of AI decision quality and accuracy

### Appeal and Review
- Documented process for individuals to contest AI-influenced decisions
- Timely human review of appeals within 10 business days
- Tracking and analysis of AI decision appeals
- Annual review of appeal patterns and outcomes
`
            },
            medium: {
                title: "Human Oversight and Accountability",
                content: `
## Purpose
Maintain human control over AI systems and ensure accountability.

## Requirements

### Human Review
- Critical decisions require human review
- Professional judgment takes precedence over AI
- Staff can override AI recommendations
- Appeal process available for AI-influenced decisions

### Accountability
- Designated owners for each AI system
- Clear responsibility for AI outcomes
- Documentation of AI use in decision-making
`
            },
            low: {
                title: "Human Oversight",
                content: `
## Purpose
Keep humans in control of AI.

## Requirements
- Humans make final decisions
- Staff can override AI
- Clear responsibility for AI systems
`
            }
        };

        // State management
        let currentRankings = [];
        let currentIntensity = 'standard';
        let policyConfig = {};

        // Event Listeners
        document.querySelectorAll('.intensity-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.intensity-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                currentIntensity = this.dataset.intensity;
            });
        });

        document.getElementById('rankingsFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    try {
                        const data = JSON.parse(event.target.result);
                        currentRankings = data.rankings || [];
                        displayPriorities();
                    } catch (error) {
                        alert('Error reading file. Please ensure it is a valid JSON file from the prioritization tool.');
                    }
                };
                reader.readAsText(file);
            }
        });

        document.getElementById('loadSampleBtn').addEventListener('click', function() {
            // Sample rankings for demonstration
            currentRankings = [
                { id: 1, name: "Data Privacy & Security", score: 10, tier: 1 },
                { id: 2, name: "Bias, Equity & Discrimination", score: 9, tier: 1 },
                { id: 3, name: "Transparency & Explainability", score: 8, tier: 1 },
                { id: 4, name: "Human Oversight & Accountability", score: 8, tier: 1 },
                { id: 5, name: "Accuracy & Validation", score: 7, tier: 2 },
                { id: 6, name: "Governance & Risk Management", score: 6, tier: 2 },
                { id: 7, name: "Training & Capacity Building", score: 6, tier: 2 },
                { id: 8, name: "Use Case Appropriateness", score: 5, tier: 3 },
                { id: 9, name: "Procurement & Vendor Management", score: 4, tier: 3 },
                { id: 10, name: "Legal & Regulatory Compliance", score: 4, tier: 3 },
                { id: 11, name: "Community Engagement", score: 3, tier: 4 },
                { id: 12, name: "Sustainability & Evaluation", score: 2, tier: 4 }
            ];
            displayPriorities();
            alert('Sample rankings loaded! You can now generate a policy document.');
        });

        document.getElementById('generateBtn').addEventListener('click', generatePolicy);
        document.getElementById('copyBtn').addEventListener('click', copyToClipboard);
        document.getElementById('printBtn').addEventListener('click', () => window.print());
        document.getElementById('downloadMdBtn').addEventListener('click', downloadMarkdown);
        document.getElementById('downloadDocxBtn').addEventListener('click', downloadDocx);
        document.getElementById('downloadPdfBtn').addEventListener('click', downloadPdf);

        function displayPriorities() {
            const list = document.getElementById('priorityList');
            const card = document.getElementById('priorityCard');
            
            list.innerHTML = currentRankings.map((item, index) => {
                let tierClass = '';
                if (index < 3) tierClass = 'tier-high';
                else if (index < 8) tierClass = 'tier-medium';
                else tierClass = 'tier-low';
                
                return `
                    <li>
                        <span>${item.name}</span>
                        <span class="rank-badge ${tierClass}">#${index + 1}</span>
                    </li>
                `;
            }).join('');
            
            card.style.display = 'block';
        }

        function generatePolicy() {
            const orgName = document.getElementById('orgName').value.trim();
            if (!orgName) {
                alert('Please enter your organization name.');
                return;
            }

            if (currentRankings.length === 0) {
                alert('Please import rankings or load sample rankings first.');
                return;
            }

            policyConfig = {
                orgName: orgName,
                jurisdictionType: document.getElementById('jurisdictionType').value,
                orgSize: document.getElementById('orgSize').value,
                intensity: currentIntensity,
                additionalContext: document.getElementById('additionalContext').value,
                date: new Date().toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })
            };

            const policyHtml = buildPolicyDocument();
            document.getElementById('policyPreview').innerHTML = policyHtml;
            document.getElementById('previewCard').style.display = 'block';
            
            // Scroll to preview
            document.getElementById('previewCard').scrollIntoView({ behavior: 'smooth' });
        }

        function buildPolicyDocument() {
            let html = `
                <h1>Artificial Intelligence Use Policy</h1>
                <p><strong>${policyConfig.orgName}</strong></p>
                <p><em>Effective Date: ${policyConfig.date}</em></p>
                <p><em>Policy Version: 1.0</em></p>
                
                <hr style="margin: 2rem 0; border: none; border-top: 2px solid var(--mist);">
                
                <h2>I. Purpose and Scope</h2>
                <div class="policy-section">
                    <p><strong>Purpose:</strong> This policy establishes a framework for the responsible development, procurement, and use of artificial intelligence (AI) technologies at ${policyConfig.orgName}. It ensures AI systems align with our mission to protect and promote public health while upholding the highest standards of ethics, equity, privacy, and transparency.</p>
                    
                    <p><strong>Scope:</strong> This policy applies to all staff, contractors, and vendors involved in the use, development, or procurement of AI technologies on behalf of ${policyConfig.orgName}. It covers all AI systems including but not limited to:</p>
                    <ul>
                        <li>Generative AI tools (e.g., ChatGPT, Claude, Gemini)</li>
                        <li>Machine learning models for data analysis and prediction</li>
                        <li>Natural language processing systems</li>
                        <li>Computer vision and image analysis tools</li>
                        <li>Decision support and automation systems</li>
                    </ul>
                </div>
                
                <h2>II. Core Principles</h2>
                <div class="policy-section">
                    <p>${policyConfig.orgName} commits to the following principles in all AI activities:</p>
                    <ul>
                        <li><strong>Public Health First:</strong> AI serves public health goals and community well-being</li>
                        <li><strong>Equity and Justice:</strong> AI promotes health equity and does not perpetuate discrimination</li>
                        <li><strong>Transparency:</strong> AI use is open, explainable, and accountable</li>
                        <li><strong>Privacy Protection:</strong> AI systems safeguard sensitive health information</li>
                        <li><strong>Human Oversight:</strong> Human judgment remains central to all decisions</li>
                        <li><strong>Continuous Learning:</strong> AI practices evolve with technology and evidence</li>
                    </ul>
                </div>
                
                <hr style="margin: 2rem 0; border: none; border-top: 2px solid var(--mist);">
                
                <h2>III. Policy Requirements</h2>
                <p><em>Requirements are prioritized based on organizational assessment and adapted for ${policyConfig.jurisdictionType} context.</em></p>
            `;

            // Add sections based on rankings
            const topPriorities = currentRankings.slice(0, 4);
            const mediumPriorities = currentRankings.slice(4, 8);
            const lowerPriorities = currentRankings.slice(8);

            // High priority sections with detailed requirements
            html += '<h3 style="color: var(--terracotta); margin-top: 2rem;">High Priority Requirements</h3>';
            topPriorities.forEach((item, index) => {
                if (policyTemplates[item.name]) {
                    const intensity = currentIntensity;
                    const template = policyTemplates[item.name][intensity] || policyTemplates[item.name]['medium'];
                    html += `
                        <div class="policy-section">
                            <h3>${String.fromCharCode(65 + index)}. ${template.title}</h3>
                            ${template.content}
                        </div>
                    `;
                }
            });

            // Medium priority sections
            html += '<h3 style="color: var(--gold); margin-top: 2rem;">Standard Requirements</h3>';
            mediumPriorities.forEach((item, index) => {
                if (policyTemplates[item.name]) {
                    const intensity = currentIntensity === 'comprehensive' ? 'medium' : 'low';
                    const template = policyTemplates[item.name][intensity] || policyTemplates[item.name]['medium'];
                    html += `
                        <div class="policy-section">
                            <h3>${String.fromCharCode(65 + topPriorities.length + index)}. ${template.title}</h3>
                            ${template.content}
                        </div>
                    `;
                }
            });

            // Lower priority sections (if comprehensive)
            if (currentIntensity === 'comprehensive') {
                html += '<h3 style="color: var(--sage); margin-top: 2rem;">Additional Considerations</h3>';
                lowerPriorities.forEach((item, index) => {
                    if (policyTemplates[item.name]) {
                        const template = policyTemplates[item.name]['low'];
                        html += `
                            <div class="policy-section">
                                <h3>${String.fromCharCode(65 + topPriorities.length + mediumPriorities.length + index)}. ${template.title}</h3>
                                ${template.content}
                            </div>
                        `;
                    }
                });
            }

            // Governance section (always included)
            html += `
                <hr style="margin: 2rem 0; border: none; border-top: 2px solid var(--mist);">
                
                <h2>IV. Governance and Implementation</h2>
                <div class="policy-section">
                    <h3>A. Roles and Responsibilities</h3>
                    <ul>
                        <li><strong>AI Governance Committee:</strong> Oversees AI policy implementation and approves high-risk AI use cases</li>
                        <li><strong>Privacy Officer:</strong> Reviews AI systems for data privacy compliance</li>
                        <li><strong>Equity Officer:</strong> Assesses AI systems for bias and equity impacts</li>
                        <li><strong>IT Security:</strong> Ensures AI systems meet cybersecurity requirements</li>
                        <li><strong>Department Heads:</strong> Accountable for AI use within their units</li>
                        <li><strong>All Staff:</strong> Required to comply with this policy</li>
                    </ul>
                    
                    <h3>B. Policy Review and Updates</h3>
                    <p>This policy will be reviewed annually and updated as needed to reflect:</p>
                    <ul>
                        <li>Changes in AI technology and capabilities</li>
                        <li>New legal or regulatory requirements</li>
                        <li>Lessons learned from AI implementation</li>
                        <li>Stakeholder feedback and concerns</li>
                    </ul>
                    
                    <h3>C. Compliance and Enforcement</h3>
                    <p>Violations of this policy may result in:</p>
                    <ul>
                        <li>Revocation of AI system access</li>
                        <li>Mandatory retraining</li>
                        <li>Disciplinary action up to and including termination</li>
                        <li>Legal action where applicable</li>
                    </ul>
                </div>
                
                <h2>V. Contact Information</h2>
                <div class="policy-section">
                    <p>Questions about this policy should be directed to:</p>
                    <p><strong>AI Policy Coordinator</strong><br>
                    ${policyConfig.orgName}<br>
                    [Contact information to be added]</p>
                </div>
                
                <hr style="margin: 2rem 0; border: none; border-top: 2px solid var(--mist);">
                
                <p style="text-align: center; font-size: 0.9rem; color: var(--sage); margin-top: 3rem;">
                    <em>This policy was generated using the AI Policy Priority Builder tool<br>
                    Based on evidence-based research from Kansas Health Institute, CDC, and other authoritative sources<br>
                    Document should be reviewed by legal counsel and adapted to local requirements</em>
                </p>
            `;

            return html;
        }

        function copyToClipboard() {
            const preview = document.getElementById('policyPreview');
            const text = preview.innerText;
            navigator.clipboard.writeText(text).then(() => {
                alert('Policy text copied to clipboard!');
            });
        }

        function downloadMarkdown() {
            const preview = document.getElementById('policyPreview');
            const html = preview.innerHTML;
            
            // Convert HTML to Markdown (simplified)
            let markdown = html
                .replace(/<h1[^>]*>(.*?)<\/h1>/g, '# $1\n\n')
                .replace(/<h2[^>]*>(.*?)<\/h2>/g, '## $1\n\n')
                .replace(/<h3[^>]*>(.*?)<\/h3>/g, '### $1\n\n')
                .replace(/<p[^>]*>(.*?)<\/p>/g, '$1\n\n')
                .replace(/<strong>(.*?)<\/strong>/g, '**$1**')
                .replace(/<em>(.*?)<\/em>/g, '*$1*')
                .replace(/<li[^>]*>(.*?)<\/li>/g, '- $1\n')
                .replace(/<ul[^>]*>/g, '\n')
                .replace(/<\/ul>/g, '\n')
                .replace(/<div[^>]*>/g, '')
                .replace(/<\/div>/g, '\n')
                .replace(/<hr[^>]*>/g, '\n---\n\n')
                .replace(/<[^>]+>/g, '');

            const blob = new Blob([markdown], { type: 'text/markdown' });
            downloadFile(blob, 'ai-policy.md');
        }

        function downloadDocx() {
            alert('DOCX generation requires python-docx library on the backend. For now, copy the text and paste into Microsoft Word, or download as Markdown and convert using pandoc.');
        }

        function downloadPdf() {
            window.print();
        }

        function downloadFile(blob, filename) {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
